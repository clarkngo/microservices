<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Service Discovery</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="/Users/clark/microservices/index.html">Java Microservices Guide</a>
        </div>
    </nav>
    <div class="container mt-5">
        <section id="service-discovery" class="py-5">
            <div class="container">
                <h2>3. Service Discovery</h2>
                <p class="lead">How services find each other in a dynamic world.</p>

                <h4>The Service Discovery Pattern</h4>
                <p>In a microservices architecture, service instances are ephemeral. They are created and destroyed dynamically, and their network locations (IP addresses and ports) change frequently. Hardcoding these locations is not feasible. The Service Discovery pattern provides a solution. It introduces a central <strong>Service Registry</strong> where each service instance registers itself on startup. When a service wants to communicate with another service, it queries the registry to get a list of available instances and their locations.</p>
                <p>There are two main flavors of service discovery:</p>
                <ul>
                    <li><strong>Client-Side Discovery:</strong> The client is responsible for querying the service registry, selecting an instance from the list (usually with a load-balancing algorithm), and making the request.</li>
                    <li><strong>Server-Side Discovery:</strong> The client makes a request to a router or load balancer, which in turn queries the service registry and routes the request to an available service instance.</li>
                </ul>

                <h4>Implementation with Java & Spring Cloud Netflix Eureka</h4>
                <p>Spring Cloud Netflix provides an integration with Eureka, a popular service registry. To use it, you first need to create a Eureka Server application.</p>
                <p><strong>Eureka Server (`application.yml`):</strong></p>
                <pre><code>
server:
  port: 8761

eureka:
  client:
    register-with-eureka: false
    fetch-registry: false
                </code></pre>
                <p>Then, you can register your microservices as Eureka clients.</p>
                <p><strong>Eureka Client (`application.yml`):</strong></p>
                <pre><code>
spring:
  application:
    name: product-service

eureka:
  client:
    serviceUrl:
      defaultZone: http://localhost:8761/eureka/
                </code></pre>

                <h4>Real-World Use Case: Auto-Scaling E-commerce Application</h4>
                <p>During a Black Friday sale, an e-commerce application experiences a massive surge in traffic. The application is configured to auto-scale, which means new instances of the `product-service` and `order-service` are created to handle the load. With service discovery, these new instances automatically register themselves with the service registry. The API Gateway and other services can then immediately discover these new instances and start routing traffic to them, ensuring the application remains available and performant.</p>

                <h4>Real-World Examples</h4>
                <ul>
                    <li><strong>Netflix Eureka:</strong> The original service registry developed by Netflix and widely used in the Spring Cloud ecosystem.</li>
                    <li><strong>HashiCorp Consul:</strong> A popular service mesh solution that includes a service registry, health checking, and a key-value store.</li>
                    <li><strong>CoreDNS:</strong> A flexible, extensible DNS server that can be used for service discovery in Kubernetes.</li>
                </ul>

                <h4>Resources</h4>
                <ul>
                    <li><a href="https://spring.io/projects/spring-cloud-netflix" target="_blank">Spring Cloud Netflix Documentation</a></li>
                    <li><a href="https://www.consul.io/" target="_blank">HashiCorp Consul</a></li>
                </ul>
            </div>
        </section>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>