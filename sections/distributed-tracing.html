<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Distributed Tracing</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="/Users/clark/microservices/index.html">Java Microservices Guide</a>
        </div>
    </nav>
    <div class="container mt-5">
        <section id="distributed-tracing" class="py-5">
            <div class="container">
                <h2>7. Distributed Tracing</h2>
                <p class="lead">Tracing requests as they span multiple services for debugging and analysis.</p>

                <h4>The Distributed Tracing Pattern</h4>
                <p>In a microservices architecture, a single request can trigger a chain of calls to multiple services. If something goes wrong, it can be difficult to pinpoint the source of the problem. Distributed tracing provides a solution by assigning a unique ID to each request and propagating it across all the services it touches. This allows you to visualize the entire request flow and identify bottlenecks or errors.</p>

                <h4>Implementation with Java & Spring Cloud Sleuth</h4>
                <p>Spring Cloud Sleuth automatically adds tracing information (a trace ID and a span ID) to your logs and propagates it over HTTP or message-based communication. You can then use a tool like Zipkin to collect and visualize these traces.</p>
                <p>To get started, add the following dependencies to your `pom.xml`:</p>
                <pre><code>
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-sleuth&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-sleuth-zipkin&lt;/artifactId&gt;
&lt;/dependency&gt;
                </code></pre>
                <p>Then, in your `application.yml`, you need to tell Sleuth where to send the traces:</p>
                <pre><code>
spring:
  zipkin:
    base-url: http://localhost:9411/
                </code></pre>

                <h4>Real-World Use Case: Debugging Latency in a Food Delivery App</h4>
                <p>A user complains that their order is taking too long to be confirmed. With distributed tracing, you can look at the trace for that user's request and see how much time was spent in each service: the `order-service`, the `restaurant-service`, and the `payment-service`. You might discover that the `payment-service` is taking several seconds to respond, which is causing the delay. This allows you to focus your debugging efforts on the right service.</p>

                <h4>Real-World Examples</h4>
                <ul>
                    <li><strong>Zipkin:</strong> A popular open-source distributed tracing system.</li>
                    <li><strong>Jaeger:</strong> Another popular open-source distributed tracing system, created by Uber.</li>
                    <li><strong>OpenTelemetry:</strong> A CNCF project that provides a single set of APIs, libraries, agents, and collector services to capture distributed traces and metrics.</li>
                </ul>

                <h4>Resources</h4>
                <ul>
                    <li><a href="https://spring.io/projects/spring-cloud-sleuth" target="_blank">Spring Cloud Sleuth Documentation</a></li>
                    <li><a href="https://opentelemetry.io/" target="_blank">OpenTelemetry</a></li>
                </ul>
            </div>
        </section>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>